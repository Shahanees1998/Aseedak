(()=>{var e={};e.id=5007,e.ids=[5007],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9195:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>h,tree:()=>c}),s(3609),s(8047),s(2874),s(2723);var a=s(7105),r=s(5265),i=s(157),n=s.n(i),o=s(4665),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let c=["",{children:["(full-page)",{children:["hotel-dashboard",{children:["subscription",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,3609)),"/Users/mac/Documents/primochatadmin/hotel-feedback-saas/app/(full-page)/hotel-dashboard/subscription/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,8047)),"/Users/mac/Documents/primochatadmin/hotel-feedback-saas/app/(full-page)/hotel-dashboard/layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(s.t.bind(s,2874,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,2723)),"/Users/mac/Documents/primochatadmin/hotel-feedback-saas/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,2874,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/mac/Documents/primochatadmin/hotel-feedback-saas/app/(full-page)/hotel-dashboard/subscription/page.tsx"],m="/(full-page)/hotel-dashboard/subscription/page",u={require:s,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(full-page)/hotel-dashboard/subscription/page",pathname:"/hotel-dashboard/subscription",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5439:(e,t,s)=>{Promise.resolve().then(s.bind(s,3658))},8608:(e,t,s)=>{Promise.resolve().then(s.bind(s,4513)),Promise.resolve().then(s.bind(s,8280))},8435:(e,t,s)=>{Promise.resolve().then(s.bind(s,4717))},895:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,3817,23)),Promise.resolve().then(s.t.bind(s,9323,23)),Promise.resolve().then(s.t.bind(s,2204,23)),Promise.resolve().then(s.t.bind(s,820,23)),Promise.resolve().then(s.t.bind(s,5915,23)),Promise.resolve().then(s.t.bind(s,1611,23))},3658:(e,t,s)=>{"use strict";s.d(t,{Providers:()=>i});var a=s(9899),r=s(878);function i({children:e}){return(0,a.jsxs)(r.SessionProvider,{children:[e,a.jsx(Object(function(){var e=Error("Cannot find module 'react-hot-toast'");throw e.code="MODULE_NOT_FOUND",e}()),{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"}}})]})}!function(){var e=Error("Cannot find module 'react-hot-toast'");throw e.code="MODULE_NOT_FOUND",e}()},4513:(e,t,s)=>{"use strict";s.d(t,{default:()=>h});var a=s(9899),r=s(878),i=s(5055),n=s(5507),o=s(8155),l=s(5678),c=s(9634),d=s(627),m=s(6969);function u(){let{data:e}=(0,r.useSession)(),[t,s]=(0,n.useState)([]),[i,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!1),x=async t=>{if(e?.user?.hotelId)try{(await fetch(`/api/notifications/hotel/${e.user.hotelId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:t})})).ok&&s(e=>e.map(e=>t.includes(e.id)?{...e,isRead:!0}:e))}catch(e){console.error("Error marking notifications as read:",e)}},b=async()=>{let e=t.filter(e=>!e.isRead).map(e=>e.id);e.length>0&&(await x(e),Object(function(){var e=Error("Cannot find module 'react-hot-toast'");throw e.code="MODULE_NOT_FOUND",e}())("All notifications marked as read"))},f=t.filter(e=>!e.isRead).length,j=e=>{switch(e){case"success":return"success";case"warning":return"warning";case"error":return"danger";default:return"info"}},g=e=>{let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/6e4);return s<1?"Just now":s<60?`${s}m ago`:s<1440?`${Math.floor(s/60)}h ago`:`${Math.floor(s/1440)}d ago`};return(0,a.jsxs)("div",{className:"relative",children:[a.jsx(o.Button,{icon:"pi pi-bell",className:"p-button-text p-button-rounded",onClick:()=>p(!h),"aria-label":"Notifications",children:f>0&&a.jsx(l.Badge,{value:f,severity:"danger"})}),a.jsx(c.T,{ref:e=>{e&&e.show(null,document.querySelector(".relative"))},visible:h,onHide:()=>p(!1),style:{width:"350px"},children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),f>0&&a.jsx(o.Button,{label:"Mark all read",size:"small",severity:"secondary",onClick:b})]}),0===t.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("i",{className:"pi pi-bell-slash text-3xl mb-2"}),a.jsx("p",{children:"No notifications"})]}):a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:t.map(e=>a.jsx(d.Card,{className:"notification-card",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900",children:e.title}),a.jsx(m.V,{value:e.type,severity:j(e.type),className:"text-xs"})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.message}),a.jsx("p",{className:"text-xs text-gray-400",children:g(e.createdAt)})]}),!e.isRead&&a.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full ml-2"})]})},e.id))})]})})]})}function h(){let{data:e}=(0,r.useSession)();return a.jsx("header",{className:"bg-white shadow-sm border-b",children:a.jsx("div",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:e?.user?.hotel?.name||"Hotel Dashboard"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[e?.user?.hotel?.city,", ",e?.user?.hotel?.state]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx(u,{}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:e?.user?.name}),a.jsx("p",{className:"text-xs text-gray-600",children:"Hotel Admin"})]}),a.jsx(i.q,{image:"/images/no-profile.jpg",shape:"circle",size:"normal",className:"cursor-pointer"})]})]})})})}!function(){var e=Error("Cannot find module 'react-hot-toast'");throw e.code="MODULE_NOT_FOUND",e}()},8280:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var a=s(9899),r=s(4175),i=s(6153),n=s(8155),o=s(878);let l=[{label:"Dashboard",icon:"pi pi-home",href:"/hotel-dashboard"},{label:"Reviews",icon:"pi pi-star",href:"/hotel-dashboard/reviews"},{label:"Forms",icon:"pi pi-file-edit",href:"/hotel-dashboard/forms"},{label:"Templates",icon:"pi pi-book",href:"/hotel-dashboard/forms/templates"},{label:"QR Codes",icon:"pi pi-qrcode",href:"/hotel-dashboard/qr-codes"},{label:"Analytics",icon:"pi pi-chart-line",href:"/hotel-dashboard/analytics"},{label:"Subscription",icon:"pi pi-credit-card",href:"/hotel-dashboard/subscription"},{label:"Settings",icon:"pi pi-cog",href:"/hotel-dashboard/settings"}];function c(){let e=(0,i.usePathname)();return(0,a.jsxs)("div",{className:"w-64 bg-white shadow-sm min-h-screen",children:[a.jsx("div",{className:"p-6",children:a.jsx("h2",{className:"text-xl font-bold text-blue-600",children:"HotelFeedback Pro"})}),a.jsx("nav",{className:"px-4",children:l.map(t=>a.jsx(r.default,{href:t.href,children:(0,a.jsxs)("div",{className:`flex items-center gap-3 px-4 py-3 rounded-lg mb-2 transition-colors ${e===t.href?"bg-blue-50 text-blue-600 border-r-2 border-blue-600":"text-gray-700 hover:bg-gray-50"}`,children:[a.jsx("i",{className:t.icon}),a.jsx("span",{className:"font-medium",children:t.label})]})},t.href))}),a.jsx("div",{className:"absolute bottom-4 left-4 right-4",children:a.jsx(n.Button,{label:"Sign Out",icon:"pi pi-sign-out",severity:"secondary",className:"w-full",onClick:()=>{(0,o.signOut)({callbackUrl:"/"})}})})]})}},4717:(e,t,s)=>{"use strict";s.d(t,{default:()=>m});var a=s(9899),r=s(5507),i=s(627),n=s(8155),o=s(6969),l=s(721),c=s(6666);if(function(){var e=Error("Cannot find module 'stripe'");throw e.code="MODULE_NOT_FOUND",e}(),!process.env.STRIPE_SECRET_KEY)throw Error("STRIPE_SECRET_KEY is not set");Object(function(){var e=Error("Cannot find module 'stripe'");throw e.code="MODULE_NOT_FOUND",e}())(process.env.STRIPE_SECRET_KEY,{apiVersion:"2023-10-16",typescript:!0});let d={plans:{basic:{name:"Basic",price:2900,interval:"month",features:["Up to 100 reviews/month","QR code generation","Basic analytics","Email support"]},premium:{name:"Premium",price:7900,interval:"month",features:["Up to 500 reviews/month","Custom forms","Advanced analytics","External sharing","Priority support"]},enterprise:{name:"Enterprise",price:19900,interval:"month",features:["Unlimited reviews","White-label options","Custom integrations","Dedicated support","API access"]}}};function m({hotel:e}){let[t,s]=(0,r.useState)(!1),[m,u]=(0,r.useState)("premium"),[h,p]=(0,r.useState)(!1),x=e=>{switch(e){case"ACTIVE":return"success";case"INACTIVE":case"PAST_DUE":return"warning";case"CANCELLED":return"danger";default:return"secondary"}},b=e=>e?new Date(e).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A",f=async()=>{p(!0);try{let e=await fetch("/api/payments/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plan:m})}),t=await e.json();e.ok?window.location.href=t.url:Object(function(){var e=Error("Cannot find module 'react-hot-toast'");throw e.code="MODULE_NOT_FOUND",e}())(t.error||"Failed to create checkout session")}catch(e){Object(function(){var e=Error("Cannot find module 'react-hot-toast'");throw e.code="MODULE_NOT_FOUND",e}())("Error creating checkout session")}finally{p(!1)}},j=async()=>{if(confirm("Are you sure you want to cancel your subscription? This will take effect at the end of your current billing period."))try{(await fetch("/api/payments/cancel-subscription",{method:"POST",headers:{"Content-Type":"application/json"}})).ok?(Object(function(){var e=Error("Cannot find module 'react-hot-toast'");throw e.code="MODULE_NOT_FOUND",e}())("Subscription will be cancelled at the end of the current period"),window.location.reload()):Object(function(){var e=Error("Cannot find module 'react-hot-toast'");throw e.code="MODULE_NOT_FOUND",e}())("Failed to cancel subscription")}catch(e){Object(function(){var e=Error("Cannot find module 'react-hot-toast'");throw e.code="MODULE_NOT_FOUND",e}())("Error cancelling subscription")}},g="ACTIVE"===e.subscriptionStatus,N=e.subscriptionId;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(i.Card,{className:"dashboard-card",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Current Subscription"}),a.jsx("p",{className:"text-gray-600",children:"Manage your subscription and billing information"})]}),a.jsx(o.V,{value:e.subscriptionStatus.replace("_"," "),severity:x(e.subscriptionStatus)})]}),N?(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Subscription Details"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Plan:"}),a.jsx("span",{className:"font-medium",children:e.subscriptionPlan||"Premium"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Status:"}),a.jsx(o.V,{value:e.subscriptionStatus.replace("_"," "),severity:x(e.subscriptionStatus)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Current Period:"}),(0,a.jsxs)("span",{className:"font-medium",children:[b(e.subscriptionStart)," - ",b(e.subscriptionEnd)]})]}),e.subscription?.cancelAtPeriodEnd&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Cancellation:"}),a.jsx("span",{className:"text-orange-600 font-medium",children:"Ends at period end"})]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Actions"}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx(n.Button,{label:"Upgrade Plan",icon:"pi pi-arrow-up",className:"w-full",onClick:()=>s(!0)}),g&&!e.subscription?.cancelAtPeriodEnd&&a.jsx(n.Button,{label:"Cancel Subscription",icon:"pi pi-times",severity:"danger",className:"w-full",onClick:j}),a.jsx(n.Button,{label:"View Billing Portal",icon:"pi pi-external-link",severity:"secondary",className:"w-full",onClick:()=>{window.open("/api/payments/customer-portal","_blank")}})]})]})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[a.jsx("i",{className:"pi pi-credit-card text-4xl text-gray-300 mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Active Subscription"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Choose a plan to start collecting guest feedback and managing reviews"}),a.jsx(n.Button,{label:"Choose a Plan",icon:"pi pi-arrow-right",onClick:()=>s(!0)})]})]}),(0,a.jsxs)(i.Card,{className:"dashboard-card",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Available Plans"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Object.entries(d.plans).map(([t,r])=>a.jsx("div",{className:`border rounded-lg p-6 ${e.subscriptionPlan===t?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r.name}),(0,a.jsxs)("div",{className:"text-3xl font-bold text-blue-600 mb-4",children:["$",r.price/100,a.jsx("span",{className:"text-lg text-gray-500",children:"/month"})]}),a.jsx("ul",{className:"text-sm text-gray-600 space-y-2 mb-6",children:r.features.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center",children:[a.jsx("i",{className:"pi pi-check text-green-500 mr-2"}),e]},t))}),e.subscriptionPlan===t?a.jsx(o.V,{value:"Current Plan",severity:"success"}):a.jsx(n.Button,{label:"Select Plan",className:"w-full",onClick:()=>{u(t),s(!0)}})]})},t))})]}),a.jsx(l.V,{header:"Upgrade Subscription",visible:t,style:{width:"50vw"},onHide:()=>s(!1),children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Plan"}),a.jsx(c.L,{value:m,onChange:e=>u(e.value),options:[{label:"Basic - $29/month",value:"basic"},{label:"Premium - $79/month",value:"premium"},{label:"Enterprise - $199/month",value:"enterprise"}],className:"w-full"})]}),m&&(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-semibold text-gray-900 mb-2",children:[d.plans[m].name," Plan"]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-blue-600 mb-2",children:["$",d.plans[m].price/100,"/month"]}),a.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:d.plans[m].features.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center",children:[a.jsx("i",{className:"pi pi-check text-green-500 mr-2"}),e]},t))})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[a.jsx(n.Button,{label:"Cancel",severity:"secondary",onClick:()=>s(!1)}),a.jsx(n.Button,{label:"Proceed to Payment",loading:h,onClick:f})]})]})})]})}!function(){var e=Error("Cannot find module 'react-hot-toast'");throw e.code="MODULE_NOT_FOUND",e}()},8047:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(5023),r=s(2588),i=s(2772);let n=(0,i.createProxy)(String.raw`/Users/mac/Documents/primochatadmin/hotel-feedback-saas/components/HotelSidebar.tsx#default`),o=(0,i.createProxy)(String.raw`/Users/mac/Documents/primochatadmin/hotel-feedback-saas/components/HotelHeader.tsx#default`);async function l({children:e}){let t=await Object(function(){var e=Error("Cannot find module 'next-auth'");throw e.code="MODULE_NOT_FOUND",e}())();return t&&t.user?.role==="HOTEL_ADMIN"||(0,r.redirect)("/auth/login"),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(o,{}),(0,a.jsxs)("div",{className:"flex",children:[a.jsx(n,{}),a.jsx("main",{className:"flex-1 p-6",children:e})]})]})}!function(){var e=Error("Cannot find module 'next-auth'");throw e.code="MODULE_NOT_FOUND",e}()},3609:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(5023);let r=(0,s(2772).createProxy)(String.raw`/Users/mac/Documents/primochatadmin/hotel-feedback-saas/components/SubscriptionManagement.tsx#default`);(function(){var e=Error("Cannot find module 'next-auth'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@prisma/client'");throw e.code="MODULE_NOT_FOUND",e}();let i=Object(function(){var e=Error("Cannot find module '@prisma/client'");throw e.code="MODULE_NOT_FOUND",e}())();async function n(){let e=await Object(function(){var e=Error("Cannot find module 'next-auth'");throw e.code="MODULE_NOT_FOUND",e}())();if(!e||e.user?.role!=="HOTEL_ADMIN"||!e.user?.hotelId)return a.jsx("div",{children:"Unauthorized"});let t=await i.hotel.findUnique({where:{id:e.user.hotelId},select:{id:!0,name:!0,subscriptionStatus:!0,subscriptionPlan:!0,subscriptionId:!0,subscriptionStart:!0,subscriptionEnd:!0,subscription:{select:{stripeCustomerId:!0,stripeSubscriptionId:!0,plan:!0,status:!0,currentPeriodStart:!0,currentPeriodEnd:!0,cancelAtPeriodEnd:!0}}}});return t?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Subscription Management"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your subscription and billing"})]}),a.jsx(r,{hotel:t})]}):a.jsx("div",{children:"Hotel not found"})}},2723:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,metadata:()=>o});var a=s(5023),r=s(8209),i=s.n(r);s(642);let n=(0,s(2772).createProxy)(String.raw`/Users/mac/Documents/primochatadmin/hotel-feedback-saas/app/providers.tsx#Providers`),o={title:"Hotel Feedback SaaS",description:"Professional guest feedback and review management platform for hotels"};function l({children:e}){return a.jsx("html",{lang:"en",children:a.jsx("body",{className:i().className,children:a.jsx(n,{children:e})})})}},642:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[916,7358,1564,696,9688,6666,8729,721],()=>s(9195));module.exports=a})();