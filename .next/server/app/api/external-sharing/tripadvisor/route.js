"use strict";(()=>{var e={};e.id=8297,e.ids=[8297],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7374:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>m,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>v,staticGenerationAsyncStorage:()=>c});var a={};t.r(a),t.d(a,{POST:()=>d});var i=t(3277),s=t(5265),n=t(5356),o=t(7076);!function(){var e=Error("Cannot find module '@prisma/client'");throw e.code="MODULE_NOT_FOUND",e}();let u=Object(function(){var e=Error("Cannot find module '@prisma/client'");throw e.code="MODULE_NOT_FOUND",e}())();async function d(e){try{let{hotelSlug:r,reviewId:t}=await e.json();if(!r||!t)return o.NextResponse.json({error:"Hotel slug and review ID are required"},{status:400});let a=await u.hotel.findUnique({where:{slug:r},select:{id:!0,name:!0,address:!0,city:!0,state:!0,country:!0}});if(!a)return o.NextResponse.json({error:"Hotel not found"},{status:404});let i=await u.review.findUnique({where:{id:t},select:{id:!0,overallRating:!0,responses:!0,guestName:!0}});if(!i)return o.NextResponse.json({error:"Review not found"},{status:404});let s=`${a.name} ${a.city} ${a.state} ${a.country}`,n=`https://www.tripadvisor.com/Search?q=${encodeURIComponent(s)}`,d="https://www.tripadvisor.com/UserReview";return await u.review.update({where:{id:t},data:{sharedOnTripAdvisor:!0,externalUrls:{tripAdvisor:n,tripAdvisorReview:d}}}),o.NextResponse.json({message:"TripAdvisor sharing URLs generated successfully",urls:{tripAdvisorSearch:n,tripAdvisorReview:d},hotel:{name:a.name,location:`${a.city}, ${a.state}, ${a.country}`},review:{rating:i.overallRating,guestName:i.guestName}})}catch(e){return console.error("Error generating TripAdvisor sharing URLs:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/external-sharing/tripadvisor/route",pathname:"/api/external-sharing/tripadvisor",filename:"route",bundlePath:"app/api/external-sharing/tripadvisor/route"},resolvedPagePath:"/Users/mac/Documents/primochatadmin/hotel-feedback-saas/app/api/external-sharing/tripadvisor/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:c,serverHooks:v}=p,h="/api/external-sharing/tripadvisor/route";function m(){return(0,n.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:c})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[916,3786],()=>t(7374));module.exports=a})();