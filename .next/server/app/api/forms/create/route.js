"use strict";(()=>{var r={};r.id=1198,r.ids=[1198],r.modules={399:r=>{r.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:r=>{r.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9596:(r,e,o)=>{o.r(e),o.d(e,{originalPathname:()=>p,patchFetch:()=>E,requestAsyncStorage:()=>O,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>f});var t={};o.r(t),o.d(t,{POST:()=>u});var n=o(3277),a=o(5265),i=o(5356),d=o(7076);(function(){var r=Error("Cannot find module 'next-auth'");throw r.code="MODULE_NOT_FOUND",r})(),function(){var r=Error("Cannot find module '@prisma/client'");throw r.code="MODULE_NOT_FOUND",r}(),function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}();let c=Object(function(){var r=Error("Cannot find module '@prisma/client'");throw r.code="MODULE_NOT_FOUND",r}())(),s=Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).object({name:Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).string().min(1,"Form name is required"),description:Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).string().optional(),fields:Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).array(Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).object({label:Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).string().min(1,"Field label is required"),type:Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).enum(["TEXT","TEXTAREA","RATING","SINGLE_CHOICE","MULTIPLE_CHOICE","EMAIL","PHONE"]),required:Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).boolean().default(!1),placeholder:Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).string().optional(),options:Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).array(Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).string()).optional(),order:Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).number().min(1)})).min(1,"At least one field is required")});async function u(r){try{let e=await Object(function(){var r=Error("Cannot find module 'next-auth'");throw r.code="MODULE_NOT_FOUND",r}())();if(!e||e.user?.role!=="HOTEL_ADMIN"||!e.user?.hotelId)return d.NextResponse.json({error:"Unauthorized"},{status:401});let o=await r.json(),t=s.parse(o),n=await c.$transaction(async r=>{let o=await r.form.create({data:{hotelId:e.user.hotelId,name:t.name,description:t.description,isActive:!0,isDefault:!1}}),n=await Promise.all(t.fields.map(e=>r.formField.create({data:{formId:o.id,label:e.label,type:e.type,required:e.required,placeholder:e.placeholder,options:e.options||[],order:e.order}})));return{...o,fields:n}});return d.NextResponse.json({message:"Form created successfully",form:{id:n.id,name:n.name,description:n.description,fields:n.fields}})}catch(r){if(console.error("Error creating form:",r),r instanceof Object(function(){var r=Error("Cannot find module 'zod'");throw r.code="MODULE_NOT_FOUND",r}()).ZodError)return d.NextResponse.json({error:"Validation error",details:r.errors},{status:400});return d.NextResponse.json({error:"Internal server error"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/forms/create/route",pathname:"/api/forms/create",filename:"route",bundlePath:"app/api/forms/create/route"},resolvedPagePath:"/Users/mac/Documents/primochatadmin/hotel-feedback-saas/app/api/forms/create/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:O,staticGenerationAsyncStorage:f,serverHooks:m}=l,p="/api/forms/create/route";function E(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:f})}}};var e=require("../../../../webpack-runtime.js");e.C(r);var o=r=>e(e.s=r),t=e.X(0,[916,3786],()=>o(9596));module.exports=t})();