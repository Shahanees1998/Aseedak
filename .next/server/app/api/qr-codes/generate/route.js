"use strict";(()=>{var e={};e.id=5313,e.ids=[5313],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8119:(e,r,o)=>{o.r(r),o.d(r,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>O,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>p});var t={};o.r(t),o.d(t,{POST:()=>u});var n=o(3277),a=o(5265),i=o(5356),d=o(7076);(function(){var e=Error("Cannot find module 'next-auth'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@prisma/client'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module 'qrcode'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}();let s=Object(function(){var e=Error("Cannot find module '@prisma/client'");throw e.code="MODULE_NOT_FOUND",e}())(),c=Object(function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}()).object({name:Object(function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}()).string().min(1,"Name is required"),description:Object(function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}()).string().optional(),formId:Object(function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}()).string().optional()});async function u(e){try{let r=await Object(function(){var e=Error("Cannot find module 'next-auth'");throw e.code="MODULE_NOT_FOUND",e}())();if(!r||r.user?.role!=="HOTEL_ADMIN")return d.NextResponse.json({error:"Unauthorized"},{status:401});let o=await e.json(),t=c.parse(o),n=r.user.hotelId;if(!n)return d.NextResponse.json({error:"Hotel not found"},{status:400});let a=process.env.APP_URL||"http://localhost:3000",i=`${a}/feedback/${r.user.hotel?.slug}`,u=await Object(function(){var e=Error("Cannot find module 'qrcode'");throw e.code="MODULE_NOT_FOUND",e}())(i,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"}}),l=await s.qrCode.create({data:{hotelId:n,name:t.name,description:t.description,url:i,imageUrl:u,isActive:!0}});return d.NextResponse.json({message:"QR code generated successfully",qrCode:{id:l.id,name:l.name,url:l.url,imageUrl:l.imageUrl}})}catch(e){if(console.error("Error generating QR code:",e),e instanceof Object(function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}()).ZodError)return d.NextResponse.json({error:"Validation error",details:e.errors},{status:400});return d.NextResponse.json({error:"Internal server error"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/qr-codes/generate/route",pathname:"/api/qr-codes/generate",filename:"route",bundlePath:"app/api/qr-codes/generate/route"},resolvedPagePath:"/Users/mac/Documents/primochatadmin/hotel-feedback-saas/app/api/qr-codes/generate/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:O,staticGenerationAsyncStorage:p,serverHooks:m}=l,f="/api/qr-codes/generate/route";function h(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:p})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[916,3786],()=>o(8119));module.exports=t})();